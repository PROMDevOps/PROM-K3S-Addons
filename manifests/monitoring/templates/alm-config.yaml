apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: alerts-dummy-00 #This make the top level of the tree
spec:
  receivers:
    - name: dummy-notifications
  route:
    groupBy:
      - alertname
    matchers:
      - matchType: =~
        name: alertname
        value: .+
---
apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: alerts-slack-01
spec:
  receivers:
    - name: slack-notifications
      slackConfigs:
        - channel: "#alarms"
          apiURL:
            name: slack-config
            key: slack-webhook-url
          username: AlertManager
  route:
    groupBy:
      - alertname
    matchers:
      - matchType: =~
        name: alertname
        value: .+
    groupInterval: 5m
    groupWait: 30s
    receiver: slack-notifications
    repeatInterval: 4h
    continue: false
